<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
<head>
<title>Roda::RodaPlugins::TypecastParams::Params</title>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
<link href='../../../../css/style.css' media='screen' rel='stylesheet' type='text/css'>
<script type='text/javascript'>
  function popupCode(url) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }
  
  function toggleCode(id) {
    var code = document.getElementById(id)
  
    code.style.display = code.style.display != 'block' ? 'block' : 'none'
    return true
  }
  
  // Make codeblocks hidden by default
  document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
</script>
</head>
<body class='page'>
<div class='class' id='wrapper'>
<div class='header'>
<h1 class='name'><span class='type'>class</span>
Roda::RodaPlugins::TypecastParams::Params
</h1>
<ol class='paths'>
<li>
<a href="../../../../files/lib/roda/plugins/typecast_params_rb.html">lib/roda/plugins/typecast_params.rb</a>
</li>
</ol>
<div class='parent'>
Superclass:
<strong>Object</strong>
</div>
</div>
<div id='content'>
<div id='text'>
<div id='description'>
<p>Class handling conversion of submitted parameters to desired types.</p>
</div>
<div id='method-list'>
<h2>Methods</h2>
<h3>Public Class</h3>
<ol>
<li><a href="#method-c-handle_type">handle_type</a></li>
<li><a href="#method-c-invalid_value_message">invalid_value_message</a></li>
<li><a href="#method-c-max_input_bytesize">max_input_bytesize</a></li>
<li><a href="#method-c-nest">nest</a></li>
<li><a href="#method-c-new">new</a></li>
</ol>
<h3>Public Instance</h3>
<ol>
<li><a href="#method-i-5B-5D">[]</a></li>
<li><a href="#method-i-array">array</a></li>
<li><a href="#method-i-array-21">array!</a></li>
<li><a href="#method-i-convert-21">convert!</a></li>
<li><a href="#method-i-convert_each-21">convert_each!</a></li>
<li><a href="#method-i-dig">dig</a></li>
<li><a href="#method-i-dig-21">dig!</a></li>
<li><a href="#method-i-fetch">fetch</a></li>
<li><a href="#method-i-present-3F">present?</a></li>
</ol>
<h3>Protected Instance</h3>
<ol>
<li><a href="#method-i-nested_params">nested_params</a></li>
<li><a href="#method-i-sub_capture">sub_capture</a></li>
<li><a href="#method-i-subkey">subkey</a></li>
</ol>
</div>
<div id='context'>
</div>
<div id='section'>
<div id='methods'>
<h2>Public Class methods</h2>
<div class='method public-class' id='method-method-c-handle_type'>
<a name='method-c-handle_type'></a>
<div class='synopsis'>
<span class='name'>handle_type</span><span class='arguments'>(type, opts=OPTS, &block)</span>

</div>
<div class='description'>

<p>Handle conversions for the given type using the given block. For a type named <code>foo</code>, this will create the following methods:</p>
<ul><li>
<p>foo(key, default=nil)</p>
</li><li>
<p>foo!(key)</p>
</li><li>
<p>convert_foo(value) # private</p>
</li><li>
<p>_convert_array_foo(value) # private</p>
</li><li>
<p>_invalid_value_message_for_foo # private</p>
</li><li>
<p>_max_input_bytesize_for_foo # private</p>
</li></ul>

<p>This method is used to define all type conversions, even the built in ones.  It can be called in subclasses to setup subclass-specific types.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-c-handle_type-source&#39;); return false'>
[show source]
</a>
<pre id='method-c-handle_type-source'>    <span class="ruby-comment"># File lib/roda/plugins/typecast_params.rb</span>
<span class="line-num">457</span> <span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier ruby-title">handle_type</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="line-num">458</span>   <span class="ruby-identifier">convert_meth</span> = <span class="ruby-value">:&quot;convert_#{type}&quot;</span>
<span class="line-num">459</span>   <span class="ruby-identifier">define_method</span>(<span class="ruby-identifier">convert_meth</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="line-num">460</span> 
<span class="line-num">461</span>   <span class="ruby-identifier">convert_array_meth</span> = <span class="ruby-value">:&quot;_convert_array_#{type}&quot;</span>
<span class="line-num">462</span>   <span class="ruby-identifier">define_method</span>(<span class="ruby-identifier">convert_array_meth</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
<span class="line-num">463</span>     <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;expected array but received #{v.inspect}&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)
<span class="line-num">464</span>     <span class="ruby-identifier">v</span>.<span class="ruby-identifier">map!</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">val</span><span class="ruby-operator">|</span>
<span class="line-num">465</span>       <span class="ruby-identifier">check_allowed_bytesize</span>(<span class="ruby-identifier">val</span>, <span class="ruby-identifier">_max_input_bytesize_for</span>(<span class="ruby-identifier">type</span>))
<span class="line-num">466</span>       <span class="ruby-identifier">check_null_byte</span>(<span class="ruby-identifier">val</span>)
<span class="line-num">467</span>       <span class="ruby-identifier">send</span>(<span class="ruby-identifier">convert_meth</span>, <span class="ruby-identifier">val</span>)
<span class="line-num">468</span>     <span class="ruby-keyword">end</span>
<span class="line-num">469</span>   <span class="ruby-keyword">end</span>
<span class="line-num">470</span> 
<span class="line-num">471</span>   <span class="ruby-identifier">private</span> <span class="ruby-identifier">convert_meth</span>, <span class="ruby-identifier">convert_array_meth</span>
<span class="line-num">472</span> 
<span class="line-num">473</span>   <span class="ruby-identifier">invalid_value_message</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">opts</span>[<span class="ruby-value">:invalid_value_message</span>])
<span class="line-num">474</span>   <span class="ruby-identifier">max_input_bytesize</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">opts</span>[<span class="ruby-value">:max_input_bytesize</span>])
<span class="line-num">475</span> 
<span class="line-num">476</span>   <span class="ruby-identifier">define_method</span>(<span class="ruby-identifier">type</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">default</span>=<span class="ruby-keyword">nil</span><span class="ruby-operator">|</span>
<span class="line-num">477</span>     <span class="ruby-identifier">process_arg</span>(<span class="ruby-identifier">convert_meth</span>, <span class="ruby-identifier">key</span>, <span class="ruby-identifier">default</span>, <span class="ruby-identifier">type</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">require_hash!</span>
<span class="line-num">478</span>   <span class="ruby-keyword">end</span>
<span class="line-num">479</span> 
<span class="line-num">480</span>   <span class="ruby-identifier">define_method</span>(<span class="ruby-value">:&quot;#{type}!&quot;</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span>
<span class="line-num">481</span>     <span class="ruby-identifier">send</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">key</span>, <span class="ruby-constant">CHECK_NIL</span>)
<span class="line-num">482</span>   <span class="ruby-keyword">end</span>
<span class="line-num">483</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-class' id='method-method-c-invalid_value_message'>
<a name='method-c-invalid_value_message'></a>
<div class='synopsis'>
<span class='name'>invalid_value_message</span><span class='arguments'>(type, message)</span>

</div>
<div class='description'>

<p>Set the invalid message for the given type.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-c-invalid_value_message-source&#39;); return false'>
[show source]
</a>
<pre id='method-c-invalid_value_message-source'>    <span class="ruby-comment"># File lib/roda/plugins/typecast_params.rb</span>
<span class="line-num">486</span> <span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier ruby-title">invalid_value_message</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">message</span>)
<span class="line-num">487</span>   <span class="ruby-identifier">invalid_value_message_meth</span> = <span class="ruby-value">:&quot;_invalid_value_message_for_#{type}&quot;</span>
<span class="line-num">488</span>   <span class="ruby-identifier">define_method</span>(<span class="ruby-identifier">invalid_value_message_meth</span>){<span class="ruby-identifier">message</span>}
<span class="line-num">489</span>   <span class="ruby-identifier">private</span> <span class="ruby-identifier">invalid_value_message_meth</span>
<span class="line-num">490</span>   <span class="ruby-identifier">alias_method</span> <span class="ruby-identifier">invalid_value_message_meth</span>, <span class="ruby-identifier">invalid_value_message_meth</span>
<span class="line-num">491</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-class' id='method-method-c-max_input_bytesize'>
<a name='method-c-max_input_bytesize'></a>
<div class='synopsis'>
<span class='name'>max_input_bytesize</span><span class='arguments'>(type, bytesize)</span>

</div>
<div class='description'>

<p>Set the maximum input bytesize for the given type.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-c-max_input_bytesize-source&#39;); return false'>
[show source]
</a>
<pre id='method-c-max_input_bytesize-source'>    <span class="ruby-comment"># File lib/roda/plugins/typecast_params.rb</span>
<span class="line-num">494</span> <span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier ruby-title">max_input_bytesize</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">bytesize</span>)
<span class="line-num">495</span>   <span class="ruby-identifier">max_input_bytesize_meth</span> = <span class="ruby-value">:&quot;_max_input_bytesize_for_#{type}&quot;</span>
<span class="line-num">496</span>   <span class="ruby-identifier">define_method</span>(<span class="ruby-identifier">max_input_bytesize_meth</span>){<span class="ruby-identifier">bytesize</span>}
<span class="line-num">497</span>   <span class="ruby-identifier">private</span> <span class="ruby-identifier">max_input_bytesize_meth</span>
<span class="line-num">498</span>   <span class="ruby-identifier">alias_method</span> <span class="ruby-identifier">max_input_bytesize_meth</span>, <span class="ruby-identifier">max_input_bytesize_meth</span>
<span class="line-num">499</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-class' id='method-method-c-nest'>
<a name='method-c-nest'></a>
<div class='synopsis'>
<span class='name'>nest</span><span class='arguments'>(obj, nesting)</span>

</div>
<div class='description'>

<p>Create a new instance with the given object and nesting level. <code>obj</code> should be an array or hash, and <code>nesting</code> should be an array.  Designed for internal use, should not be called by external code.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-c-nest-source&#39;); return false'>
[show source]
</a>
<pre id='method-c-nest-source'>    <span class="ruby-comment"># File lib/roda/plugins/typecast_params.rb</span>
<span class="line-num">505</span> <span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier ruby-title">nest</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-identifier">nesting</span>)
<span class="line-num">506</span>   <span class="ruby-identifier">v</span> = <span class="ruby-identifier">allocate</span>
<span class="line-num">507</span>   <span class="ruby-identifier">v</span>.<span class="ruby-identifier">instance_variable_set</span>(<span class="ruby-value">:@nesting</span>, <span class="ruby-identifier">nesting</span>)
<span class="line-num">508</span>   <span class="ruby-identifier">v</span>.<span class="ruby-identifier">send</span>(<span class="ruby-value">:initialize</span>, <span class="ruby-identifier">obj</span>)
<span class="line-num">509</span>   <span class="ruby-identifier">v</span>
<span class="line-num">510</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-class' id='method-method-c-new'>
<a name='method-c-new'></a>
<div class='synopsis'>
<span class='name'>new</span><span class='arguments'>(obj)</span>

</div>
<div class='description'>

<p>Set the object used for converting.  Conversion methods will convert members of the passed object.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-c-new-source&#39;); return false'>
[show source]
</a>
<pre id='method-c-new-source'>    <span class="ruby-comment"># File lib/roda/plugins/typecast_params.rb</span>
<span class="line-num">599</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">initialize</span>(<span class="ruby-identifier">obj</span>)
<span class="line-num">600</span>   <span class="ruby-keyword">case</span> <span class="ruby-ivar">@obj</span> = <span class="ruby-identifier">obj</span>
<span class="line-num">601</span>   <span class="ruby-keyword">when</span> <span class="ruby-constant">Hash</span>, <span class="ruby-constant">Array</span>
<span class="line-num">602</span>     <span class="ruby-comment"># nothing</span>
<span class="line-num">603</span>   <span class="ruby-keyword">else</span>
<span class="line-num">604</span>     <span class="ruby-keyword">if</span> <span class="ruby-ivar">@nesting</span>
<span class="line-num">605</span>       <span class="ruby-identifier">handle_error</span>(<span class="ruby-keyword">nil</span>, (<span class="ruby-ivar">@obj</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">?</span> <span class="ruby-value">:missing</span> <span class="ruby-operator">:</span> <span class="ruby-value">:invalid_type</span>), <span class="ruby-node">&quot;value of #{param_name(nil)} parameter not an array or hash: #{obj.inspect}&quot;</span>, <span class="ruby-keyword">true</span>)
<span class="line-num">606</span>     <span class="ruby-keyword">else</span>
<span class="line-num">607</span>       <span class="ruby-identifier">handle_error</span>(<span class="ruby-keyword">nil</span>, <span class="ruby-value">:invalid_type</span>, <span class="ruby-node">&quot;parameters given not an array or hash: #{obj.inspect}&quot;</span>, <span class="ruby-keyword">true</span>)
<span class="line-num">608</span>     <span class="ruby-keyword">end</span>
<span class="line-num">609</span>   <span class="ruby-keyword">end</span>
<span class="line-num">610</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<h2>Public Instance methods</h2>
<div class='method public-instance' id='method-method-i-5B-5D'>
<a name='method-i-5B-5D'></a>
<div class='synopsis'>
<span class='name'>[]</span><span class='arguments'>(key)</span>

</div>
<div class='description'>

<p>Return a new <a href="Params.html"><code>Params</code></a> instance for the given <code>key</code>. The value of <code>key</code> should be an array if <code>key</code> is an integer, or hash otherwise.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-5B-5D-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-5B-5D-source'>    <span class="ruby-comment"># File lib/roda/plugins/typecast_params.rb</span>
<span class="line-num">629</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">[]</span>(<span class="ruby-identifier">key</span>)
<span class="line-num">630</span>   <span class="ruby-ivar">@subs</span> <span class="ruby-operator">||=</span> {}
<span class="line-num">631</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">sub</span> = <span class="ruby-ivar">@subs</span>[<span class="ruby-identifier">key</span>]
<span class="line-num">632</span>     <span class="ruby-keyword">return</span> <span class="ruby-identifier">sub</span>
<span class="line-num">633</span>   <span class="ruby-keyword">end</span>
<span class="line-num">634</span> 
<span class="line-num">635</span>   <span class="ruby-keyword">if</span> <span class="ruby-ivar">@obj</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)
<span class="line-num">636</span>     <span class="ruby-keyword">unless</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Integer</span>)
<span class="line-num">637</span>       <span class="ruby-identifier">handle_error</span>(<span class="ruby-identifier">key</span>, <span class="ruby-value">:invalid_type</span>, <span class="ruby-node">&quot;invalid use of non-integer key for accessing array: #{key.inspect}&quot;</span>, <span class="ruby-keyword">true</span>)
<span class="line-num">638</span>     <span class="ruby-keyword">end</span>
<span class="line-num">639</span>   <span class="ruby-keyword">else</span>
<span class="line-num">640</span>     <span class="ruby-keyword">if</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Integer</span>)
<span class="line-num">641</span>       <span class="ruby-identifier">handle_error</span>(<span class="ruby-identifier">key</span>, <span class="ruby-value">:invalid_type</span>, <span class="ruby-node">&quot;invalid use of integer key for accessing hash: #{key}&quot;</span>, <span class="ruby-keyword">true</span>)
<span class="line-num">642</span>     <span class="ruby-keyword">end</span>
<span class="line-num">643</span>   <span class="ruby-keyword">end</span>
<span class="line-num">644</span> 
<span class="line-num">645</span>   <span class="ruby-identifier">v</span> = <span class="ruby-ivar">@obj</span>[<span class="ruby-identifier">key</span>]
<span class="line-num">646</span>   <span class="ruby-identifier">v</span> = <span class="ruby-keyword">yield</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">yield</span>)
<span class="line-num">647</span> 
<span class="line-num">648</span>   <span class="ruby-keyword">begin</span>
<span class="line-num">649</span>     <span class="ruby-identifier">sub</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">nest</span>(<span class="ruby-identifier">v</span>, <span class="ruby-constant">Array</span>(<span class="ruby-ivar">@nesting</span>) <span class="ruby-operator">+</span> [<span class="ruby-identifier">key</span>])
<span class="line-num">650</span>   <span class="ruby-keyword">rescue</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">e</span>
<span class="line-num">651</span>     <span class="ruby-identifier">handle_error</span>(<span class="ruby-identifier">key</span>, <span class="ruby-value">:invalid_type</span>, <span class="ruby-identifier">e</span>, <span class="ruby-keyword">true</span>)
<span class="line-num">652</span>   <span class="ruby-keyword">end</span>
<span class="line-num">653</span> 
<span class="line-num">654</span>   <span class="ruby-ivar">@subs</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-identifier">sub</span>
<span class="line-num">655</span>   <span class="ruby-identifier">sub</span>.<span class="ruby-identifier">sub_capture</span>(<span class="ruby-ivar">@capture</span>, <span class="ruby-ivar">@symbolize</span>, <span class="ruby-ivar">@skip_missing</span>)
<span class="line-num">656</span>   <span class="ruby-identifier">sub</span>
<span class="line-num">657</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-array'>
<a name='method-i-array'></a>
<div class='synopsis'>
<span class='name'>array</span><span class='arguments'>(type, key, default=nil)</span>

</div>
<div class='description'>

<p>Convert the value of <code>key</code> to an array of values of the given <code>type</code>. If <code>default</code> is given, any <code>nil</code> values in the array are replaced with <code>default</code>.  If <code>key</code> is an array then this returns an array of arrays, one for each respective value of <code>key</code>. If there is no value for <code>key</code>, nil is returned instead of an array.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-array-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-array-source'>    <span class="ruby-comment"># File lib/roda/plugins/typecast_params.rb</span>
<span class="line-num">766</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">array</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">key</span>, <span class="ruby-identifier">default</span>=<span class="ruby-keyword">nil</span>)
<span class="line-num">767</span>   <span class="ruby-identifier">meth</span> = <span class="ruby-value">:&quot;_convert_array_#{type}&quot;</span>
<span class="line-num">768</span>   <span class="ruby-identifier">raise</span> <span class="ruby-constant">ProgrammerError</span>, <span class="ruby-node">&quot;no typecast_params type registered for #{type.inspect}&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">meth</span>, <span class="ruby-keyword">true</span>)
<span class="line-num">769</span>   <span class="ruby-identifier">process_arg</span>(<span class="ruby-identifier">meth</span>, <span class="ruby-identifier">key</span>, <span class="ruby-identifier">default</span>, <span class="ruby-identifier">type</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">require_hash!</span>
<span class="line-num">770</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-array-21'>
<a name='method-i-array-21'></a>
<div class='synopsis'>
<span class='name'>array!</span><span class='arguments'>(type, key, default=nil)</span>

</div>
<div class='description'>

<p>Call <code>array</code> with the <code>type</code>, <code>key</code>, and <code>default</code>, but if the return value is nil or any value in the returned array is <code>nil</code>, raise an <a href="Error.html"><code>Error</code></a>.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-array-21-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-array-21-source'>    <span class="ruby-comment"># File lib/roda/plugins/typecast_params.rb</span>
<span class="line-num">774</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">array!</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">key</span>, <span class="ruby-identifier">default</span>=<span class="ruby-keyword">nil</span>)
<span class="line-num">775</span>   <span class="ruby-identifier">v</span> = <span class="ruby-identifier">array</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">key</span>, <span class="ruby-identifier">default</span>)
<span class="line-num">776</span> 
<span class="line-num">777</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)
<span class="line-num">778</span>     <span class="ruby-identifier">key</span>.<span class="ruby-identifier">zip</span>(<span class="ruby-identifier">v</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">arr</span><span class="ruby-operator">|</span>
<span class="line-num">779</span>       <span class="ruby-identifier">check_array!</span>(<span class="ruby-identifier">k</span>, <span class="ruby-identifier">arr</span>)
<span class="line-num">780</span>     <span class="ruby-keyword">end</span>
<span class="line-num">781</span>   <span class="ruby-keyword">else</span>
<span class="line-num">782</span>     <span class="ruby-identifier">check_array!</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">v</span>)
<span class="line-num">783</span>   <span class="ruby-keyword">end</span>
<span class="line-num">784</span> 
<span class="line-num">785</span>   <span class="ruby-identifier">v</span>
<span class="line-num">786</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-convert-21'>
<a name='method-i-convert-21'></a>
<div class='synopsis'>
<span class='name'>convert!</span><span class='arguments'>(keys=nil, opts=OPTS)</span>

</div>
<div class='description'>

<p>Captures conversions inside the given block, and returns a hash of all conversions, including conversions of subkeys.  <code>keys</code> should be an array of subkeys to access, or nil to convert the current object. If <code>keys</code> is given as a hash, it is used as the options hash. Options:</p>
<table class="rdoc-list note-list"><tbody><tr><td class='label'>:raise </td><td>
<p>If set to false, do not raise errors for missing keys</p>
</td></tr><tr><td class='label'>:skip_missing </td><td>
<p>If set to true, does not store values if the key is not present in the params.</p>
</td></tr><tr><td class='label'>:symbolize </td><td>
<p>Convert any string keys in the resulting hash and for any conversions below</p>
</td></tr></tbody></table>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-convert-21-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-convert-21-source'>    <span class="ruby-comment"># File lib/roda/plugins/typecast_params.rb</span>
<span class="line-num">675</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">convert!</span>(<span class="ruby-identifier">keys</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)
<span class="line-num">676</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)
<span class="line-num">677</span>     <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">keys</span>
<span class="line-num">678</span>     <span class="ruby-identifier">keys</span> = <span class="ruby-keyword">nil</span>
<span class="line-num">679</span>   <span class="ruby-keyword">end</span>
<span class="line-num">680</span> 
<span class="line-num">681</span>   <span class="ruby-identifier">_capture!</span>(<span class="ruby-value">:nested_params</span>, <span class="ruby-identifier">opts</span>) <span class="ruby-keyword">do</span>
<span class="line-num">682</span>     <span class="ruby-keyword">if</span> <span class="ruby-identifier">sub</span> = <span class="ruby-identifier">subkey</span>(<span class="ruby-constant">Array</span>(<span class="ruby-identifier">keys</span>).<span class="ruby-identifier">dup</span>, <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-value">:raise</span>, <span class="ruby-keyword">true</span>))
<span class="line-num">683</span>       <span class="ruby-keyword">yield</span> <span class="ruby-identifier">sub</span>
<span class="line-num">684</span>     <span class="ruby-keyword">end</span>
<span class="line-num">685</span>   <span class="ruby-keyword">end</span>
<span class="line-num">686</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-convert_each-21'>
<a name='method-i-convert_each-21'></a>
<div class='synopsis'>
<span class='name'>convert_each!</span><span class='arguments'>(opts=OPTS, &block)</span>

</div>
<div class='description'>

<p>Runs conversions similar to convert! for each key specified by the :keys option.  If :keys option is not given and the object is an array, runs conversions for all entries in the array.  If the :keys option is not given and the object is a Hash with string keys ‘0’, ‘1’, …, ‘N’ (with no skipped keys), runs conversions for all entries in the hash.  If :keys option is a Proc or a Method, calls the proc/method with the current object, which should return an array of keys to use. Supports options given to <a href="Params.html#method-i-convert-21"><code>convert!</code></a>, and this additional option:</p>
<table class="rdoc-list note-list"><tbody><tr><td class='label'>:keys </td><td>
<p>The keys to extract from the object. If a proc or method, calls the value with the current object, which should return the array of keys to use.</p>
</td></tr></tbody></table>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-convert_each-21-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-convert_each-21-source'>    <span class="ruby-comment"># File lib/roda/plugins/typecast_params.rb</span>
<span class="line-num">699</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">convert_each!</span>(<span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="line-num">700</span>   <span class="ruby-identifier">np</span> = <span class="ruby-operator">!</span><span class="ruby-ivar">@capture</span>
<span class="line-num">701</span> 
<span class="line-num">702</span>   <span class="ruby-identifier">_capture!</span>(<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">opts</span>) <span class="ruby-keyword">do</span>
<span class="line-num">703</span>     <span class="ruby-keyword">case</span> <span class="ruby-identifier">keys</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:keys</span>]
<span class="line-num">704</span>     <span class="ruby-keyword">when</span> <span class="ruby-keyword">nil</span>
<span class="line-num">705</span>       <span class="ruby-identifier">keys</span> = (<span class="ruby-value">0</span><span class="ruby-operator">...</span><span class="ruby-ivar">@obj</span>.<span class="ruby-identifier">length</span>)
<span class="line-num">706</span> 
<span class="line-num">707</span>       <span class="ruby-identifier">valid</span> = <span class="ruby-keyword">if</span> <span class="ruby-ivar">@obj</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)
<span class="line-num">708</span>         <span class="ruby-keyword">true</span>
<span class="line-num">709</span>       <span class="ruby-keyword">else</span>
<span class="line-num">710</span>         <span class="ruby-identifier">keys</span> = <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">map</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:to_s</span>)
<span class="line-num">711</span>         <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">all?</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">k</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@obj</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">k</span>)}
<span class="line-num">712</span>       <span class="ruby-keyword">end</span>
<span class="line-num">713</span> 
<span class="line-num">714</span>       <span class="ruby-keyword">unless</span> <span class="ruby-identifier">valid</span>
<span class="line-num">715</span>         <span class="ruby-identifier">handle_error</span>(<span class="ruby-keyword">nil</span>, <span class="ruby-value">:invalid_type</span>, <span class="ruby-string">&quot;convert_each! called on object not an array or hash with keys &#39;0&#39;..&#39;N&#39;&quot;</span>)
<span class="line-num">716</span>         <span class="ruby-keyword">next</span> 
<span class="line-num">717</span>       <span class="ruby-keyword">end</span>
<span class="line-num">718</span>     <span class="ruby-keyword">when</span> <span class="ruby-constant">Array</span>
<span class="line-num">719</span>       <span class="ruby-comment"># nothing to do</span>
<span class="line-num">720</span>     <span class="ruby-keyword">when</span> <span class="ruby-constant">Proc</span>, <span class="ruby-constant">Method</span>
<span class="line-num">721</span>       <span class="ruby-identifier">keys</span> = <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">call</span>(<span class="ruby-ivar">@obj</span>)
<span class="line-num">722</span>     <span class="ruby-keyword">else</span>
<span class="line-num">723</span>       <span class="ruby-identifier">raise</span> <span class="ruby-constant">ProgrammerError</span>, <span class="ruby-node">&quot;unsupported convert_each! :keys option: #{keys.inspect}&quot;</span>
<span class="line-num">724</span>     <span class="ruby-keyword">end</span>
<span class="line-num">725</span> 
<span class="line-num">726</span>     <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
<span class="line-num">727</span>       <span class="ruby-keyword">begin</span>
<span class="line-num">728</span>         <span class="ruby-keyword">if</span> <span class="ruby-identifier">v</span> = <span class="ruby-identifier">subkey</span>([<span class="ruby-identifier">i</span>], <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-value">:raise</span>, <span class="ruby-keyword">true</span>))
<span class="line-num">729</span>           <span class="ruby-keyword">yield</span> <span class="ruby-identifier">v</span>
<span class="line-num">730</span>           <span class="ruby-identifier">v</span>.<span class="ruby-identifier">nested_params</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">np</span> 
<span class="line-num">731</span>         <span class="ruby-keyword">end</span>
<span class="line-num">732</span>       <span class="ruby-keyword">rescue</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">e</span>
<span class="line-num">733</span>         <span class="ruby-identifier">handle_error</span>(<span class="ruby-identifier">i</span>, <span class="ruby-value">:invalid_type</span>, <span class="ruby-identifier">e</span>)
<span class="line-num">734</span>       <span class="ruby-keyword">end</span>
<span class="line-num">735</span>     <span class="ruby-keyword">end</span>
<span class="line-num">736</span>   <span class="ruby-keyword">end</span>
<span class="line-num">737</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-dig'>
<a name='method-i-dig'></a>
<div class='synopsis'>
<span class='name'>dig</span><span class='arguments'>(type, *nest, key)</span>

</div>
<div class='description'>

<p>Convert values nested under the current obj.  Traverses the current object using <code>nest</code>, then converts <code>key</code> on that object using <code>type</code>:</p>

<pre class="ruby"><span class="ruby-identifier">tp</span>.<span class="ruby-identifier">dig</span>(<span class="ruby-value">:pos_int</span>, <span class="ruby-string">&#39;foo&#39;</span>)               <span class="ruby-comment"># tp.pos_int(&#39;foo&#39;)</span>
<span class="ruby-identifier">tp</span>.<span class="ruby-identifier">dig</span>(<span class="ruby-value">:pos_int</span>, <span class="ruby-string">&#39;foo&#39;</span>, <span class="ruby-string">&#39;bar&#39;</span>)        <span class="ruby-comment"># tp[&#39;foo&#39;].pos_int(&#39;bar&#39;)</span>
<span class="ruby-identifier">tp</span>.<span class="ruby-identifier">dig</span>(<span class="ruby-value">:pos_int</span>, <span class="ruby-string">&#39;foo&#39;</span>, <span class="ruby-string">&#39;bar&#39;</span>, <span class="ruby-string">&#39;baz&#39;</span>) <span class="ruby-comment"># tp[&#39;foo&#39;][&#39;bar&#39;].pos_int(&#39;baz&#39;)</span>
</pre>

<p>Returns nil if any of the values are not present or not the expected type. If the nest path results in an object that is not an array or hash, then raises an <a href="Error.html"><code>Error</code></a>.</p>

<p>You can use <code>dig</code> to get access to nested arrays by using <code>:array</code> or <code>:array!</code> as the first argument and providing the type in the second argument:</p>

<pre class="ruby"><span class="ruby-identifier">tp</span>.<span class="ruby-identifier">dig</span>(<span class="ruby-value">:array</span>, <span class="ruby-value">:pos_int</span>, <span class="ruby-string">&#39;foo&#39;</span>, <span class="ruby-string">&#39;bar&#39;</span>, <span class="ruby-string">&#39;baz&#39;</span>)  <span class="ruby-comment"># tp[&#39;foo&#39;][&#39;bar&#39;].array(:pos_int, &#39;baz&#39;)</span>
</pre>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-dig-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-dig-source'>    <span class="ruby-comment"># File lib/roda/plugins/typecast_params.rb</span>
<span class="line-num">753</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">dig</span>(<span class="ruby-identifier">type</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">nest</span>, <span class="ruby-identifier">key</span>)
<span class="line-num">754</span>   <span class="ruby-identifier">_dig</span>(<span class="ruby-keyword">false</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">nest</span>, <span class="ruby-identifier">key</span>)
<span class="line-num">755</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-dig-21'>
<a name='method-i-dig-21'></a>
<div class='synopsis'>
<span class='name'>dig!</span><span class='arguments'>(type, *nest, key)</span>

</div>
<div class='description'>

<p>Similar to <code>dig</code>, but raises an <a href="Error.html"><code>Error</code></a> instead of returning <code>nil</code> if no value is found.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-dig-21-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-dig-21-source'>    <span class="ruby-comment"># File lib/roda/plugins/typecast_params.rb</span>
<span class="line-num">758</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">dig!</span>(<span class="ruby-identifier">type</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">nest</span>, <span class="ruby-identifier">key</span>)
<span class="line-num">759</span>   <span class="ruby-identifier">_dig</span>(<span class="ruby-keyword">true</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">nest</span>, <span class="ruby-identifier">key</span>)
<span class="line-num">760</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-fetch'>
<a name='method-i-fetch'></a>
<div class='synopsis'>
<span class='name'>fetch</span><span class='arguments'>(key)</span>

</div>
<div class='description'>

<p>Return the nested value for key. If there is no nested_value for <code>key</code>, calls the block to return the value, or returns nil if there is no block given.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-fetch-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-fetch-source'>    <span class="ruby-comment"># File lib/roda/plugins/typecast_params.rb</span>
<span class="line-num">661</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">fetch</span>(<span class="ruby-identifier">key</span>)
<span class="line-num">662</span>   <span class="ruby-identifier">send</span>(<span class="ruby-value">:[]</span>, <span class="ruby-identifier">key</span>){<span class="ruby-keyword">return</span>(<span class="ruby-keyword">yield</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">yield</span>))}
<span class="line-num">663</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-present-3F'>
<a name='method-i-present-3F'></a>
<div class='synopsis'>
<span class='name'>present?</span><span class='arguments'>(key)</span>

</div>
<div class='description'>

<p>If key is a String Return whether the key is present in the object,</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-present-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-present-3F-source'>    <span class="ruby-comment"># File lib/roda/plugins/typecast_params.rb</span>
<span class="line-num">613</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">present?</span>(<span class="ruby-identifier">key</span>)
<span class="line-num">614</span>   <span class="ruby-keyword">case</span> <span class="ruby-identifier">key</span>
<span class="line-num">615</span>   <span class="ruby-keyword">when</span> <span class="ruby-constant">String</span>
<span class="line-num">616</span>     <span class="ruby-operator">!</span><span class="ruby-identifier">any</span>(<span class="ruby-identifier">key</span>).<span class="ruby-identifier">nil?</span>
<span class="line-num">617</span>   <span class="ruby-keyword">when</span> <span class="ruby-constant">Array</span>
<span class="line-num">618</span>     <span class="ruby-identifier">key</span>.<span class="ruby-identifier">all?</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span><span class="ruby-operator">|</span>
<span class="line-num">619</span>       <span class="ruby-identifier">raise</span> <span class="ruby-constant">ProgrammerError</span>, <span class="ruby-node">&quot;non-String element in array argument passed to present?: #{k.inspect}&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">k</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>)
<span class="line-num">620</span>       <span class="ruby-operator">!</span><span class="ruby-identifier">any</span>(<span class="ruby-identifier">k</span>).<span class="ruby-identifier">nil?</span>
<span class="line-num">621</span>     <span class="ruby-keyword">end</span>
<span class="line-num">622</span>   <span class="ruby-keyword">else</span>
<span class="line-num">623</span>     <span class="ruby-identifier">raise</span> <span class="ruby-constant">ProgrammerError</span>, <span class="ruby-node">&quot;unexpected argument passed to present?: #{key.inspect}&quot;</span>
<span class="line-num">624</span>   <span class="ruby-keyword">end</span>
<span class="line-num">625</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<h2>Protected Instance methods</h2>
<div class='method protected-instance' id='method-method-i-nested_params'>
<a name='method-i-nested_params'></a>
<div class='synopsis'>
<span class='name'>nested_params</span><span class='arguments'>()</span>

</div>
<div class='description'>

<p>Recursively descendent into all known subkeys and get the converted params from each.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-nested_params-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-nested_params-source'>    <span class="ruby-comment"># File lib/roda/plugins/typecast_params.rb</span>
<span class="line-num">791</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">nested_params</span>
<span class="line-num">792</span>   <span class="ruby-keyword">return</span> <span class="ruby-ivar">@nested_params</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@nested_params</span>
<span class="line-num">793</span> 
<span class="line-num">794</span>   <span class="ruby-identifier">params</span> = <span class="ruby-ivar">@params</span>
<span class="line-num">795</span> 
<span class="line-num">796</span>   <span class="ruby-keyword">if</span> <span class="ruby-ivar">@subs</span>
<span class="line-num">797</span>     <span class="ruby-ivar">@subs</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
<span class="line-num">798</span>       <span class="ruby-keyword">if</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">symbolize?</span>
<span class="line-num">799</span>         <span class="ruby-identifier">key</span> = <span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_sym</span>
<span class="line-num">800</span>       <span class="ruby-keyword">end</span>
<span class="line-num">801</span>       <span class="ruby-identifier">params</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-identifier">v</span>.<span class="ruby-identifier">nested_params</span>
<span class="line-num">802</span>     <span class="ruby-keyword">end</span>
<span class="line-num">803</span>   <span class="ruby-keyword">end</span>
<span class="line-num">804</span>   
<span class="line-num">805</span>   <span class="ruby-identifier">params</span>
<span class="line-num">806</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method protected-instance' id='method-method-i-sub_capture'>
<a name='method-i-sub_capture'></a>
<div class='synopsis'>
<span class='name'>sub_capture</span><span class='arguments'>(capture, symbolize, skip_missing)</span>

</div>
<div class='description'>

<p>Inherit given capturing and symbolize setting from parent object.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sub_capture-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sub_capture-source'>    <span class="ruby-comment"># File lib/roda/plugins/typecast_params.rb</span>
<span class="line-num">845</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sub_capture</span>(<span class="ruby-identifier">capture</span>, <span class="ruby-identifier">symbolize</span>, <span class="ruby-identifier">skip_missing</span>)
<span class="line-num">846</span>   <span class="ruby-keyword">if</span> <span class="ruby-ivar">@capture</span> = <span class="ruby-identifier">capture</span>
<span class="line-num">847</span>     <span class="ruby-ivar">@symbolize</span> = <span class="ruby-identifier">symbolize</span>
<span class="line-num">848</span>     <span class="ruby-ivar">@skip_missing</span> = <span class="ruby-identifier">skip_missing</span>
<span class="line-num">849</span>     <span class="ruby-ivar">@params</span> = <span class="ruby-ivar">@obj</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">new</span>
<span class="line-num">850</span>   <span class="ruby-keyword">end</span>
<span class="line-num">851</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method protected-instance' id='method-method-i-subkey'>
<a name='method-i-subkey'></a>
<div class='synopsis'>
<span class='name'>subkey</span><span class='arguments'>(keys, do_raise)</span>

</div>
<div class='description'>

<p>Recursive method to get subkeys.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-subkey-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-subkey-source'>    <span class="ruby-comment"># File lib/roda/plugins/typecast_params.rb</span>
<span class="line-num">809</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">subkey</span>(<span class="ruby-identifier">keys</span>, <span class="ruby-identifier">do_raise</span>)
<span class="line-num">810</span>   <span class="ruby-keyword">unless</span> <span class="ruby-identifier">key</span> = <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">shift</span>
<span class="line-num">811</span>     <span class="ruby-keyword">return</span> <span class="ruby-keyword">self</span>
<span class="line-num">812</span>   <span class="ruby-keyword">end</span>
<span class="line-num">813</span> 
<span class="line-num">814</span>   <span class="ruby-identifier">reason</span> = <span class="ruby-value">:invalid_type</span>
<span class="line-num">815</span> 
<span class="line-num">816</span>   <span class="ruby-keyword">case</span> <span class="ruby-identifier">key</span>
<span class="line-num">817</span>   <span class="ruby-keyword">when</span> <span class="ruby-constant">String</span>
<span class="line-num">818</span>     <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@obj</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)
<span class="line-num">819</span>       <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;parameter #{param_name(nil)} is not a hash&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">do_raise</span>
<span class="line-num">820</span>       <span class="ruby-keyword">return</span>
<span class="line-num">821</span>     <span class="ruby-keyword">end</span>
<span class="line-num">822</span>     <span class="ruby-identifier">present</span> = <span class="ruby-operator">!</span><span class="ruby-ivar">@obj</span>[<span class="ruby-identifier">key</span>].<span class="ruby-identifier">nil?</span>
<span class="line-num">823</span>   <span class="ruby-keyword">when</span> <span class="ruby-constant">Integer</span>
<span class="line-num">824</span>     <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@obj</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)
<span class="line-num">825</span>       <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;parameter #{param_name(nil)} is not an array&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">do_raise</span>
<span class="line-num">826</span>       <span class="ruby-keyword">return</span>
<span class="line-num">827</span>     <span class="ruby-keyword">end</span>
<span class="line-num">828</span>     <span class="ruby-identifier">present</span> = <span class="ruby-identifier">key</span> <span class="ruby-operator">&lt;</span> <span class="ruby-ivar">@obj</span>.<span class="ruby-identifier">length</span>
<span class="line-num">829</span>   <span class="ruby-keyword">else</span>
<span class="line-num">830</span>     <span class="ruby-identifier">raise</span> <span class="ruby-constant">ProgrammerError</span>, <span class="ruby-node">&quot;invalid argument used to traverse parameters: #{key.inspect}&quot;</span>
<span class="line-num">831</span>   <span class="ruby-keyword">end</span>
<span class="line-num">832</span> 
<span class="line-num">833</span>   <span class="ruby-keyword">unless</span> <span class="ruby-identifier">present</span>
<span class="line-num">834</span>     <span class="ruby-identifier">reason</span> = <span class="ruby-value">:missing</span>
<span class="line-num">835</span>     <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;parameter #{param_name(key)} is not present&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">do_raise</span>
<span class="line-num">836</span>     <span class="ruby-keyword">return</span>
<span class="line-num">837</span>   <span class="ruby-keyword">end</span>
<span class="line-num">838</span> 
<span class="line-num">839</span>   <span class="ruby-keyword">self</span>[<span class="ruby-identifier">key</span>].<span class="ruby-identifier">subkey</span>(<span class="ruby-identifier">keys</span>, <span class="ruby-identifier">do_raise</span>)
<span class="line-num">840</span> <span class="ruby-keyword">rescue</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">e</span>
<span class="line-num">841</span>   <span class="ruby-identifier">handle_error</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">reason</span>, <span class="ruby-identifier">e</span>)
<span class="line-num">842</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
</div>
</div>

</div>
</div>

<div id='footer-push'></div>
</div>
<div id='footer'>
<a href="https://github.com/jeremyevans/hanna"><strong>Hanna</strong> RDoc template</a>
</div>
</body>
</html>
