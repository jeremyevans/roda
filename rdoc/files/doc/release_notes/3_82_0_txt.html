<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
<head>
<title>3.82.0.txt</title>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
<link href='../../../css/style.css' media='screen' rel='stylesheet' type='text/css'>
<script type='text/javascript'>
  function popupCode(url) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }
  
  function toggleCode(id) {
    var code = document.getElementById(id)
  
    code.style.display = code.style.display != 'block' ? 'block' : 'none'
    return true
  }
  
  // Make codeblocks hidden by default
  document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
</script>
</head>
<body class='page'>
<div class='file' id='wrapper'>
<div class='header'>
<h1 class='name'>3.82.0.txt
</h1>
<div class='paths'>
doc/release_notes/3.82.0.txt
</div>
<div class='last-update'>
Last Update:
<span class='datetime'>2024-07-12 07:56:42 -0700</span>
</div>
</div>
<div id='content'>
<div id='text'>
<div id='description'>
<h1 id="label-New+Features">New Features<span><a href="#label-New+Features">&para;</a> <a href="#top">&uarr;</a></span></h1>
<ul><li>
<p>A :zstd option has been added to the public and multi_public plugins to support serving zstd-compressed files with a .zst extension. This option is similar to the existing :gzip and :brotli plugin options.  Chrome started supporting zstd encoding in March.</p>
</li><li>
<p>An :encodings option has been added to the public and multi_public plugins, for more control over how encodings are handled.  This allows for changing the order in which encodings are attempted, the use of custom encodings, and the use of different file extensions for encodings.  Example:</p>

<pre class="ruby"><span class="ruby-identifier">plugin</span> <span class="ruby-value">:public</span>, <span class="ruby-value">encodings:</span> {<span class="ruby-string">&#39;zstd&#39;</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;.zst&#39;</span>, <span class="ruby-string">&#39;deflate&#39;</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;.deflate&#39;</span>}
</pre>

<p>If the :encodings option is not provided, the :zstd, :brotli, and :gzip options are used to build an equivalent :encodings option.</p>
</li></ul>

<h1 id="label-Other+Improvements">Other Improvements<span><a href="#label-Other+Improvements">&para;</a> <a href="#top">&uarr;</a></span></h1>
<ul><li>
<p>The capture_erb plugin now integrates better when using erubi/capture_block for &lt;%= method do %&gt; support in ERB templates, using the native capture method provided by the buffer object.</p>
</li><li>
<p>Encoding handling has been more optimized in the public plugin. Regexps for the encodings are precomputed, avoiding a regexp allocation per request per encoding attempted. On Ruby 2.4+ Regexp#match? is used for better performance.  If the Accept-Encoding header is not present, no encoding matching is attemped.</p>
</li></ul>

<h1 id="label-Backwards+Compatibility">Backwards Compatibility<span><a href="#label-Backwards+Compatibility">&para;</a> <a href="#top">&uarr;</a></span></h1>
<ul><li>
<p>The private public_serve_compressed request method in the public plugin now assumes it is called after the encoding is already valid. If you are calling this method in your own code, you now need to perform checks to make sure the client can accept the encoding before calling this method.</p>
</li><li>
<p>The :public_gzip and :public_brotli application options are no longer set by the public plugin.  The :public_encodings option is now set.</p>
</li></ul>
</div>
<div id='context'>
</div>

</div>
</div>

<div id='footer-push'></div>
</div>
<div id='footer'>
<a href="https://github.com/jeremyevans/hanna"><strong>Hanna</strong> RDoc template</a>
</div>
</body>
</html>
