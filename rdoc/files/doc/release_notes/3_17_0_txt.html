<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
<head>
<title>3.17.0.txt</title>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
<link href='../../../css/style.css' media='screen' rel='stylesheet' type='text/css'>
<script type='text/javascript'>
  function popupCode(url) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }
  
  function toggleCode(id) {
    var code = document.getElementById(id)
  
    code.style.display = code.style.display != 'block' ? 'block' : 'none'
    return true
  }
  
  // Make codeblocks hidden by default
  document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
</script>
</head>
<body class='page'>
<div class='file' id='wrapper'>
<div class='header'>
<h1 class='name'>3.17.0.txt
</h1>
<div class='paths'>
doc/release_notes/3.17.0.txt
</div>
</div>
<div id='content'>
<div id='text'>
<div id='description'>
<h1 id="label-New+Features">New Features<span><a href="#label-New+Features">&para;</a> <a href="#top">&uarr;</a></span></h1>
<ul><li>
<p>A route_block_args plugin has been added, allowing you to customize which objects are yielded to the the route block. You call the plugin with a block, which is evaluated in the context of the instance and should return an array of arguments for the instance to yield to the route block.</p>

<p>To yield both the request and response objects, you can do:</p>

<pre class="ruby"><span class="ruby-identifier">plugin</span> <span class="ruby-value">:route_block_args</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span>
  [<span class="ruby-identifier">r</span>, <span class="ruby-identifier">response</span>]
<span class="ruby-keyword">end</span>

<span class="ruby-identifier">route</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">r</span>, <span class="ruby-identifier">response</span><span class="ruby-operator">|</span>
  <span class="ruby-comment"># ...</span>
<span class="ruby-keyword">end</span>
</pre>

<p>In addition to the main route block, using this plugin also affects the arguments passed to routing blocks in the following plugins:</p>
<ul><li>
<p>class_level_routing</p>
</li><li>
<p>mailer</p>
</li><li>
<p>mail_processor</p>
</li><li>
<p>multi_route</p>
</li><li>
<p>static_routing</p>
</li></ul>
</li></ul>

<h1 id="label-Other+Improvements">Other Improvements<span><a href="#label-Other+Improvements">&para;</a> <a href="#top">&uarr;</a></span></h1>
<ul><li>
<p>The set_layout_opts method in the view_options plugin can now override the layout template even if the render plugin :layout option is given.</p>
</li><li>
<p>The mailer and mail_processor plugin now integrate with the hooks plugin to support before/after hooks.</p>
</li><li>
<p>Dispatching to the route block and RodaResponse#finish are both slightly faster.</p>
</li><li>
<p>Internal before hook handling has been moved from an internal plugin into the core, and modified so that if you are not using the internal before hook in any plugin, there is no runtime cost.</p>
</li><li>
<p>The core now recognizes when plugins are using the internal after hook, and automatically loads the internal plugin supporting the after hook.</p>
</li></ul>

<h1 id="label-Backwards+Compatibility">Backwards Compatibility<span><a href="#label-Backwards+Compatibility">&para;</a> <a href="#top">&uarr;</a></span></h1>
<ul><li>
<p>When using the render plugin with a :layout option, the render_opts :layout option will be set to true if the layout is enabled. Previously, the render_opts :layout option would retain the value given as the plugin option.  Options for the layout (including the template) are still available in the render_opts :layout_opts option.  This change was made to fix the set_layout_opts bug in the view_options plugin.</p>
</li><li>
<p>RodaResponse#initialize no longer sets the response status to nil if it was already set.</p>
</li><li>
<p>RodaResponse#finish no longer sets the status on the receiver, it just uses the receiverâ€™s status to set the rack response status.</p>
</li></ul>
</div>
<div id='context'>
</div>

</div>
</div>

<div id='footer-push'></div>
</div>
<div id='footer'>
<a href="https://github.com/jeremyevans/hanna"><strong>Hanna</strong> RDoc template</a>
</div>
</body>
</html>
